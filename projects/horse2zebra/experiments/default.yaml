project_dir: null

train:
    output_dir: "./checkpoints/horse2zebra_new_exp/"
    cuda: True
    n_iters: 117700
    n_iters_decay: 117700
    batch_size: 1
    mixed_precision: False

    logging:
        freq: 50
        wandb:
            project: "horse2zebra"
            run: "cyclegan-trial"

    checkpointing:
        freq: 20000

    dataset: 
        name: "ImageDataset"
        root: "/home/zk315372/Chinmay/Datasets/horse2zebra/train"
        shuffle: True
        num_workers: 16
        image_channels: 3
        preprocess: "resize"
        load_size: 256
        flip: True

    gan:  
        name: "CycleGAN"
        generator:  
            name: "Resnet2D"
            n_residual_blocks: 9
            in_channels: 3

        discriminator:  
            name: "PatchGAN2D"
            n_layers: 3
            in_channels: 3

        optimizer:
            lambda_A: 10.0
            lambda_B: 10.0
            lambda_identity: 0
            proportion_ssim: 0
            lr_D: 0.0002
            lr_G: 0.0002
    
    metrics:
        discriminator_evolution: True
        ssim: True

        

infer:
    checkpointing:
        load_iter: 1
    dataset:
        name: "ImageDataset"
        root: "/work/ft002207/horse2zebra/test/"
        num_workers: 16
        image_channels: 3
        preprocess: "resize"
        load_size: 256
        flip: False

        

# Val and test for testing purposes only, horse2zebra has no paired images
# so it makes no sense to calculate the metrics between an A and B
val:
    freq: 100
    dataset: 
        name: "ImageDataset"
        root: "/home/zk315372/Chinmay/Datasets/horse2zebra/test"
        shuffle: False
        num_workers: 8
        image_channels: 3
        preprocess: "resize"
        load_size: 256
        flip: False

# test:
#     checkpointing:
#         load_iter: 1
#     dataset:
#         name: "ImageDataset"
#         root: "/home/zk315372/Chinmay/Datasets/horse2zebra/test"
#         num_workers: 16
#         image_channels: 3
#         preprocess: "resize"
#         load_size: 256
#         flip: False